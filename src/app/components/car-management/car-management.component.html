<div class="container py-5">
  <h1 class="text-center text-danger mb-4">Car Inventory</h1>
  <div class="row">
    <!-- Form Section -->
    <div class="col-md-6">
      <form [formGroup]="carForm" (ngSubmit)="submitCar()" class="border p-4 rounded shadow-sm bg-light">
        <h2 class="text-center text-danger mb-4">Enter Car Details</h2>

        <div class="mb-3">
          <label for="brand" class="form-label">Brand</label>
          <input id="brand" type="text" formControlName="brand" class="form-control" />
          <div *ngIf="carForm.get('brand')?.invalid && carForm.get('brand')?.touched" class="text-danger">
            Brand is required (2–30 characters).
          </div>
        </div>

        <div class="mb-3">
          <label for="model" class="form-label">Model</label>
          <input id="model" type="text" formControlName="model" class="form-control" />
          <div *ngIf="carForm.get('model')?.invalid && carForm.get('model')?.touched" class="text-danger">
            Model is required (2–30 characters).
          </div>
        </div>

        <div class="mb-3">
          <label for="year" class="form-label">Year</label>
          <input id="year" type="number" formControlName="year" class="form-control" />
          <div *ngIf="carForm.get('year')?.invalid && carForm.get('year')?.touched" class="text-danger">
            Year must be between 1870 and the current year.
          </div>
        </div>

        <div class="mb-3">
          <label for="mileage" class="form-label">Mileage</label>
          <input id="mileage" type="number" formControlName="mileage" class="form-control" />
          <div *ngIf="carForm.get('mileage')?.invalid && carForm.get('mileage')?.touched" class="text-danger">
            Mileage must be 0 or higher.
          </div>
        </div>

        <div class="mb-3">
          <label for="price" class="form-label">Price (€)</label>
          <input id="price" type="number" formControlName="price" class="form-control" />
          <div *ngIf="carForm.get('price')?.invalid && carForm.get('price')?.touched" class="text-danger">
            Price must be 0 or higher.
          </div>
        </div>

        <button type="submit" class="btn btn-danger w-100 mb-2">
          {{ editingCarId ? 'Update Car' : 'Add Car' }}
        </button>
        <button type="button" class="btn btn-secondary w-100" (click)="resetForm()">Clear</button>
      </form>
    </div>

    <!-- Sorting Section -->
    <div class="col-md-6">
      <div class="border p-4 rounded shadow-sm bg-light">
        <h2 class="text-center text-danger mb-4">Sort By</h2>
        <div class="mb-3">
          <label for="sort" class="form-label">Sort Criteria</label>
          <select id="sort" class="form-select" (change)="onSortChange($event)">
            <option value="">Select</option>
            <option value="year-asc">Year (Lowest)</option>
            <option value="year-desc">Year (Highest)</option>
            <option value="mileage-asc">Mileage (Lowest)</option>
            <option value="mileage-desc">Mileage (Highest)</option>
            <option value="price-asc">Price (Lowest)</option>
            <option value="price-desc">Price (Highest)</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Table Section -->
  <div class="mt-5">
    <table class="table table-bordered table-striped">
      <thead class="table-danger">
        <tr>
          <th>Brand</th>
          <th>Model</th>
          <th>Year</th>
          <th>Mileage</th>
          <th>Price</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let car of cars">
          <td>{{ car.brand }}</td>
          <td>{{ car.model }}</td>
          <td>{{ car.year }}</td>
          <td>{{ car.mileage }}</td>
          <td>{{ car.price | currency: 'EUR':'symbol':'1.2-2' }}</td>
          <td>
            <button class="btn btn-primary btn-sm" (click)="editCar(car)">Edit</button>
            <button class="btn btn-danger btn-sm" (click)="deleteCar(car._id || '')">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
